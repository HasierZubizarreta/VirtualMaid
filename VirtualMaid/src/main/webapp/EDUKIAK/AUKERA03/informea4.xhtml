<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html">
<head>
	<link rel="stylesheet" href="../ESTILOA/informea.css"/>
	<title>03 AUKERA</title>
</head>
<h:body>
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
<h:form class="menuNagusirakoBotoia">
  	<h:commandLink class="menuNagusirakoBotoia" action="#{aukera3AtazakMB.resetView()}">
	<input class="menuNagusirakoBotoiaInput" type="submit" id="submit" value="HOME" />
	</h:commandLink>
</h:form>
<div class="container">
    <div class="column">
      <canvas id="myChartAste"></canvas>
    </div> 
    <div class="column">
      <canvas id="myChartHilabete"></canvas>
    </div>
</div>
<h:outputScript>
const ctxA = document.getElementById('myChartAste').getContext('2d');
const ctxH = document.getElementById('myChartHilabete').getContext('2d');

const dataAD = [#{aukera3ViewMB.astekoKontsumoaLortu().get(0).prezioa},#{aukera3ViewMB.astekoKontsumoaLortu().get(1).prezioa},#{aukera3ViewMB.astekoKontsumoaLortu().get(2).prezioa},#{aukera3ViewMB.astekoKontsumoaLortu().get(3).prezioa},#{aukera3ViewMB.astekoKontsumoaLortu().get(4).prezioa},#{aukera3ViewMB.astekoKontsumoaLortu().get(5).prezioa},#{aukera3ViewMB.astekoKontsumoaLortu().get(6).prezioa}];
const dataHD = [#{aukera3ViewMB.hilabetekaKontsumoaKalkulatu().get(0).prezioa}, #{aukera3ViewMB.hilabetekaKontsumoaKalkulatu().get(1).prezioa}, #{aukera3ViewMB.hilabetekaKontsumoaKalkulatu().get(2).prezioa}, #{aukera3ViewMB.hilabetekaKontsumoaKalkulatu().get(3).prezioa}, #{aukera3ViewMB.hilabetekaKontsumoaKalkulatu().get(4).prezioa}, #{aukera3ViewMB.hilabetekaKontsumoaKalkulatu().get(5).prezioa}, #{aukera3ViewMB.hilabetekaKontsumoaKalkulatu().get(6).prezioa},#{aukera3ViewMB.hilabetekaKontsumoaKalkulatu().get(7).prezioa},#{aukera3ViewMB.hilabetekaKontsumoaKalkulatu().get(8).prezioa},#{aukera3ViewMB.hilabetekaKontsumoaKalkulatu().get(9).prezioa},#{aukera3ViewMB.hilabetekaKontsumoaKalkulatu().get(10).prezioa},#{aukera3ViewMB.hilabetekaKontsumoaKalkulatu().get(11).prezioa}];

const backgroundColor = Array(7).fill('rgba(255, 99, 132, 0.2)');
const borderColor = Array(7).fill('rgba(255, 99, 132, 1)');

// Datos para el histograma
const dataA = {
  labels: ['Astelehena', 'Asteartea', 'Asteazkena', 'Osteguna', 'Ostirala', 'Larunbata', 'Igandea'],
  datasets: [{
    label: 'Asteroko Gastua',
    data: dataAD,
    backgroundColor: backgroundColor,
    borderColor: borderColor,
    borderWidth: 1
  }]
};

// Configuración del histograma
const optionsA = {
  scales: {
    x: {
      title: {
        display: true,
        text: 'Asteko Egunak'
      }
    },
    y: {
      title: {
        display: true,
        text: 'Gastua (€)'
      }
    }
  }
};
// Datos para el histograma
const dataH = {
  labels: ['Urtarrila','Otsaila','Martxoa','Apirila','Maiatza','Ekaina','Uztaila','Abuztua','Iraila','Urria','Azaroa','Abendua'],
  datasets: [{
    label: 'Hileroko Gastua',
    data: dataHD,
    backgroundColor: backgroundColor,
    borderColor: borderColor,
    borderWidth: 1
  }]
};

// Configuración del histograma
const optionsH = {
  scales: {
    x: {
      title: {
        display: true,
        text: 'Urteko Hilabeteak'
      }
    },
    y: {
      title: {
        display: true,
        text: 'Gastua (€)'
      }
    }
  }
};

// Creamos el histograma
const myChartA = new Chart(ctxA, {
  type: 'bar',
  data: dataA,
  options: optionsA
});
const myChartH = new Chart(ctxH, {
  type: 'bar',
  data: dataH,
  options: optionsH
});
</h:outputScript>
<h2>GASTUA</h2>
<br/>
 <h:form>
	<table class="formularioa">
	<tr>
        <th>NOIZTIK</th><th>NORA</th><th>EKINTZA</th>
        </tr>
		<tr>
			<td>
				<h:inputText value="#{aukera3FormMB.noiztik}" id="noiztik" required="true" requiredMessage="ERROREA: Data (NOIZTIK) eremua derrigorrezkoa da">
					<f:convertDateTime type="date" pattern="yyyy/MM/dd" timeZone="CET"/>
  				</h:inputText>	
  				<h:message for="noiztik" style="color:red" />		
			</td>
			<td>
				<h:inputText value="#{aukera3FormMB.nora}" id="nora" required="true" requiredMessage="ERROREA: Data (NORA) eremua derrigorrezkoa da">
					<f:convertDateTime type="date" pattern="yyyy/MM/dd" timeZone="CET"/>
  				</h:inputText>	
  				<h:message for="nora" style="color:red" />				
			</td>
			<td>
				<h:commandButton actionListener="#{aukera3AtazakMB.labOrrModuaAldatu(aukera3ViewMB)}" id="submit" value="ENTER" />    		
    		</td>
		</tr>
	</table>
 </h:form>
 <br/>
 <h:panelGroup rendered="#{aukera3AtazakMB.labOrrModua==0}">
 <h2>HILABETE HONETAN EGINDAKO KONTSUMOA</h2>
 <!-- Default moduan hilabeteko kontsumoa sartu -->
 </h:panelGroup>	
 <h:panelGroup rendered="#{aukera3AtazakMB.labOrrModua==1}">	
 <h2>HAUTATUTAKO DATEN ARTEAN EGINDAKO KONTSUMOA</h2>
 	<h:dataTable value="#{aukera3ViewMB.kontsumoaLortu(aukera3FormMB)}" var="kontsumoa">
 		<h:column>
   			<f:facet name="header">DATA</f:facet>
   			#{kontsumoa.data.year}/#{kontsumoa.data.monthValue}/#{kontsumoa.data.dayOfMonth}
   		</h:column>
   		<h:column>
   			<f:facet name="header">KONTSUMO TOTALA</f:facet>
   			#{kontsumoa.kontsumoa}
   		</h:column>
   		<h:column>
   			<f:facet name="header">GASTU TOTALA</f:facet>
   			#{kontsumoa.prezioa}
   		</h:column>
	</h:dataTable>	   		
</h:panelGroup>	
</h:body>
</html>